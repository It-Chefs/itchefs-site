<!-- üç≥ Agogy Gold Banner -->
<div class="agogy-bar">
  üç≥ Chef Avian & Skunkah Kitchen ¬∑ <em>Agogy Gold Edition 2025</em>
</div>

<!-- üçØ Load Agogy Styles -->
<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

<!-- ‚öôÔ∏è Agogy Injectors (footer, docs-nav, motion, brand, hero logo) -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  // ===== helpers =====
  var base = '{{ site.baseurl | default: "" }}';

  // ===== footer =====
  var f = document.querySelector('.site-footer');
  if (f) {
    f.innerHTML = '<div class="ag-footer">¬© ' + new Date().getFullYear() +
      ' IT Chefs Studios ‚Äî <strong>Agogy Gold Edition</strong> ¬∑ ' +
      '<a href="https://github.com/It-Chefs/itchefs-site">GitHub</a> ¬∑ ' +
      '<a href="https://github.com/It-Chefs/itchefs-site/blob/main/LICENSE">License</a></div>';
  }

  // ===== docs nav =====
  var header = document.querySelector('.page-header');
  if (header) {
    var docsBase = base + '/docs';
    var links = [
      { href: docsBase + '/',            label: 'Home' },
      { href: docsBase + '/kitchen/',    label: 'Briefs' },
      { href: docsBase + '/automation/', label: 'Playbooks' },
      { href: docsBase + '/branding/',   label: 'Branding' },
      { href: docsBase + '/tests/',      label: 'Tests' }
    ];
    var nav = document.createElement('nav');
    nav.className = 'ag-nav';
    nav.setAttribute('aria-label','Primary');
    nav.innerHTML = links.map(function(i){ return '<a href="'+i.href+'">'+i.label+'</a>'; }).join('');
    header.insertAdjacentElement('beforebegin', nav);

    var here = location.pathname;
    Array.from(nav.querySelectorAll('a')).forEach(function(a){
      try {
        var ap = new URL(a.href, location.origin).pathname;
        if (here === ap || (ap !== docsBase + '/' && here.startsWith(ap))) a.classList.add('active');
      } catch(e){}
    });
  }

  // ===== motion polish =====
  var hero = document.querySelector('.page-header');
  if (hero) {
    hero.classList.add('ag-ambient');
    var name = hero.querySelector('.project-name');
    var tag  = hero.querySelector('.project-tagline');
    var brandHTML = 'IT&nbsp;Chefs<span class="tm">‚Ñ¢</span>';
    if (name) { name.innerHTML = brandHTML; name.classList.add('ag-shimmer'); }
    if (tag)  { tag.classList.add('ag-shimmer'); }
    try { document.title = 'IT Chefs ‚Äî Where Automation Meets Art‚Ñ¢'; } catch(e){}
  }

  // ===== showtime toggle =====
  var bar = document.querySelector('.agogy-bar');
  var toggle = null, toggleLabel = null;
  function applyMode(mode){
    document.documentElement.setAttribute('data-motion', mode);
    localStorage.setItem('agogy.motion', mode);
    if (toggle) {
      toggle.classList.toggle('on', mode === 'hype');
      toggleLabel.textContent = 'Showtime: ' + (mode === 'hype' ? 'ON' : 'OFF');
    }
  }
  if (bar) {
    toggle = document.createElement('button');
    toggle.className = 'ag-toggle';
    toggle.setAttribute('type','button');
    toggle.setAttribute('aria-label','Toggle Showtime animations');
    toggle.innerHTML = '<span class="dot" aria-hidden="true"></span><span class="label">Showtime</span>';
    toggleLabel = toggle.querySelector('.label');
    bar.style.position = 'fixed';
    bar.appendChild(toggle);
    toggle.addEventListener('click', function(){
      var current = document.documentElement.getAttribute('data-motion') || 'hype';
      applyMode(current === 'hype' ? 'calm' : 'hype');
    });
    bar.classList.add('ag-breathe');
  }
  var prefersReduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  applyMode(prefersReduce ? 'calm' : (localStorage.getItem('agogy.motion') || 'hype'));

  // ===== hero logo (single source of truth; same path as when it worked) =====
  if (hero && !hero.querySelector('.ag-logo')) {
    var titleEl = hero.querySelector('.project-name') || hero;
    var img = document.createElement('img');
    img.className = 'ag-logo';
    img.alt = 'IT Chefs Logo';
    img.decoding = 'async';
    img.loading  = 'eager';

    // This path is correct when the file lives at: docs/assets/img/itchefs-mark.png
    img.src = "{{ '/assets/img/itchefs-logo-gold.png' | relative_url }}";

    // tiny belt-and-suspenders: if primary ever fails, try docs/ variant once
    var triedFallback = false;
    img.onerror = function(){
      if (!triedFallback) {
        triedFallback = true;
        img.src = base + '/docs/assets/img/itchefs-mark.png';
      }
    };

    titleEl.insertAdjacentElement('afterend', img);
  }
});
</script>
