<!-- üç≥ Agogy Gold Banner -->
<div class="agogy-bar">
  üç≥ Chef Avian & Skunkah Kitchen ¬∑ <em>Agogy Gold Edition 2025</em>
</div>

<!-- üçØ Load Agogy Styles -->
<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

<!-- ‚öôÔ∏è Agogy Reflex Injectors (footer, nav, motion, showtime) -->
<script>
document.addEventListener('DOMContentLoaded', function () {

  /* === Footer Injector === */
  var f = document.querySelector('.site-footer');
  if (f) {
    f.innerHTML = `
      <div class="ag-footer">
        <span>¬© ${new Date().getFullYear()} IT Chefs Studios ‚Äî <strong>Agogy Gold Edition</strong></span>
        ¬∑ <a href="https://github.com/It-Chefs/itchefs-site">GitHub</a>
        ¬∑ <a href="https://github.com/It-Chefs/itchefs-site/blob/main/LICENSE">License</a>
      </div>
    `;
  }

  /* === Top Navigation Injector (Docs-Friendly) === */
  var header = document.querySelector('.page-header');
  if (header) {
    var base = '{{ site.baseurl | default: "" }}';
    var docsBase = base + '/docs';

    var links = [
      { href: docsBase + '/',              label: 'Home' },
      { href: docsBase + '/kitchen/',      label: 'Briefs' },
      { href: docsBase + '/automation/',   label: 'Playbooks' },
      { href: docsBase + '/branding/',     label: 'Branding' },
      { href: docsBase + '/tests/',        label: 'Tests' }
    ];

    var nav = document.createElement('nav');
    nav.className = 'ag-nav';
    nav.setAttribute('aria-label','Primary');
    nav.innerHTML = links.map(function (i) {
      return '<a href="' + i.href + '">' + i.label + '</a>';
    }).join('');

    // Insert nav just before the hero
    header.insertAdjacentElement('beforebegin', nav);

    // Active link highlight
    var here = location.pathname;
    Array.from(nav.querySelectorAll('a')).forEach(function(a){
      try {
        var ap = new URL(a.href, location.origin).pathname;
        if (here === ap || (ap !== docsBase + '/' && here.startsWith(ap))) {
          a.classList.add('active');
        }
      } catch(e) {}
    });
  }

  /* === Motion Suite: shimmer + ambient + breathe + CTA pulse === */
  var hero = document.querySelector('.page-header');
  if (hero) {
    hero.classList.add('ag-ambient');
    var name = hero.querySelector('.project-name');
    var tag  = hero.querySelector('.project-tagline');
    if (name) name.classList.add('ag-shimmer');
    if (tag)  tag.classList.add('ag-shimmer');
  }

  var bar = document.querySelector('.agogy-bar');
  if (bar) bar.classList.add('ag-breathe');

  var cta = document.querySelector('.btn');
  if (cta) cta.classList.add('ag-pulse');

  /* === Showtime Toggle (Calm ‚áÑ Hype) === */
  function getQueryMode() {
    var m = new URLSearchParams(location.search).get('mode');
    return m && (m === 'hype' || m === 'calm') ? m : null;
  }
  var prefersReduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  var saved = localStorage.getItem('agogy.motion');
  var qmode = getQueryMode();
  var initial = prefersReduce ? 'calm' : (qmode || saved || 'hype');

  function applyMode(mode){
    document.documentElement.setAttribute('data-motion', mode);
    if (toggle) {
      toggle.classList.toggle('on', mode === 'hype');
      toggleLabel.textContent = 'Showtime: ' + (mode === 'hype' ? 'ON' : 'OFF');
    }
    localStorage.setItem('agogy.motion', mode);
  }

  // Create the pill toggle in the gold bar (top-right)
  var toggle = null, toggleLabel = null;
  if (bar) {
    toggle = document.createElement('button');
    toggle.className = 'ag-toggle';
    toggle.setAttribute('type','button');
    toggle.setAttribute('aria-label','Toggle Showtime animations');
    toggle.innerHTML = '<span class="dot" aria-hidden="true"></span><span class="label">Showtime</span>';
    toggleLabel = toggle.querySelector('.label');
   // bar.style.position = 'relative'; // ‚Üê delete or comment out
    bar.appendChild(toggle);


    toggle.addEventListener('click', function(){
      var current = document.documentElement.getAttribute('data-motion') || 'hype';
      var next = current === 'hype' ? 'calm' : 'hype';
      applyMode(next);
    });
  }

  if (prefersReduce) initial = 'calm';
  applyMode(initial);
});
</script>
